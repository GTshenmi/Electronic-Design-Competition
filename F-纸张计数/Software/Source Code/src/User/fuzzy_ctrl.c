#define IS_Kp 1
#define IS_Ki 2
#define IS_Kd 3
 
#include "include.h"
#include "fuzzy_ctrl.h"
 
float fuzzyRuleKp[7][7]={
	PL,	PL,	PM,	PM,	PS,	PS,	ZE,
	PL,	PL,	PM,	PM,	PS,	ZE,	ZE,
	PM,	PM,	PM,	PS,	ZE,	NS,	NM,
	PM,	PS,	PS,	ZE,	NS,	NM,	NM,
	PS,	PS,	ZE,	NS,	NS,	NM,	NM,
	ZE,	ZE,	NS,	NM,	NM,	NM,	NL,
	ZE,	NS,	NS,	NM,	NM,	NL,	NL
};
 
float fuzzyRuleKi[7][7]={
	NL,	NL,	NL,	NM,	NM,	ZE,	ZE,
	NL,	NL,	NM,	NM,	NS,	ZE,	ZE,
	NM,	NM,	NS,	NS,	ZE,	PS,	PS,
	NM,	NS,	NS,	ZE,	PS,	PS,	PM,
	NS,	NS,	ZE,	PS,	PS,	PM,	PM,
	ZE,	ZE,	PS,	PM,	PM,	PL,	PL,
	ZE,	ZE,	PS,	PM,	PL,	PL,	PL
};
 
float fuzzyRuleKd[7][7]={
	PS,	PS,	ZE,	ZE,	ZE,	PL,	PL,
	NS,	NS,	NS,	NS,	ZE,	NS,	PM,
	NL,	NL,	NM,	NS,	ZE,	PS,	PM,
	NL,	NM,	NM,	NS,	ZE,	PS,	PM,
	NL,	NM,	NS,	NS,	ZE,	PS,	PS,
	NM,	NS,	NS,	NS,	ZE,	PS,	PS,
	PS,	ZE,	ZE,	ZE,	ZE,	PL,	PL
};
 
/*
  线性量化
*/
void  LinearQuantization(float *this_error,float *delta_error,float max_error,float min_error) // -6~+6
{  
   *this_error = 6.0*(*this_error)/(max_error-min_error);
   *delta_error = 3.0*(*delta_error)/(max_error-min_error);  
}
/*
  隶属度计算
*/
void CalcMembership()
{
  
  
}

/*
  模糊推理
*/
void FuzzyComputation()
{

  
}


 
 void FuzzyCtrl()
 {
    pid_ctrl_t result = {0, 0, 0};
    
    result = fuzzy(Steer.PID_Error,Steer.PID_Error-Steer.PID_PreError);
    
    Steer.Kp = result.Kp;
    Steer.Ki = result.Ki;
    Steer.Kd = result.Kd;
 } 
 
 
 
pid_ctrl_t fuzzy(float e,float ec)
{
 
     float etemp,ectemp;
     float eLefttemp,ecLefttemp;
     float eRighttemp ,ecRighttemp;
 
     int eLeftIndex,ecLeftIndex;
     int eRightIndex,ecRightIndex;  //-95 ...-25 -15 -5 0 5 15 25 35 45 55 65 75 85 95 
     pid_ctrl_t      fuzzy_PID;
     
     
     if(e>90.0||e<-90.0)
     {
        etemp = 8.5;//MAX       
     }
     else if(e <= 5 && e>=-5)
     {
        etemp = 0.0;
     }   
     else
     {
        if(e>=0.0)
        {
            if (e>=85.0)
              etemp = 8.5;
            else if(e>=75.0)
              etemp = 7.5;
            else if(e>=65.0)
              etemp = 6.5;
            else if(e>=55.0)
              etemp = 5.5;
            else if (e>=45.0)  
              etemp = 4.5;
            else if (e>=35.0) 
               etemp = 3.5;
            else if (e>=25.0)  
              etemp = 2.5;
            else if (e>=15.0) 
               etemp = 1.5;   
            else
               etemp = 0.5;
        }
        else
        {
          
            if (e>=-85.0)
              etemp = -8.5;
            else if(e>=75.0)
              etemp = -7.5;
            else if(e>=65.0)
              etemp = -6.5;
            else if(e>=55.0)
              etemp = -5.5;
            else if (e>=45.0)  
              etemp = -4.5;
            else if (e>=35.0) 
               etemp = -3.5;
            else if (e>=25.0)  
              etemp = -2.5;
            else if (e>=15.0) 
               etemp = -1.5;   
            else
               etemp = -0.5;      
        }     
     }
     //etemp = e > 3.0 ? 0.0 : (e < - 3.0 ? 0.0 : (e >= 0.0 ? (e >= 2.0 ? 2.5: (e >= 1.0 ? 1.5 : 0.5)) : (e >= -1.0 ? -0.5 : (e >= -2.0 ? -1.5 : (e >= -3.0 ? -2.5 : 0.0) ))));
 
     eLeftIndex = (int)e;
     eRightIndex = eLeftIndex;
     eLeftIndex = (int)((etemp-0.5) + 10);        //[-10,10] -> [0,20]
     eRightIndex = (int)((etemp+0.5) + 10);
 
     eLefttemp =etemp == 0.0 ? 0.0:((etemp+0.5)-e);
     eRighttemp=etemp == 0.0 ? 0.0:( e-(etemp-0.5));
 
     if(ec>90.0||ec<-90.0)
     {
        ectemp = 8.5;//MAX       
     }
     else if(ec <= 5 && ec>=-5)
     {
        ectemp = 0.0;
     }   
     else
     {
        if(ec>=0.0)
        {
            if (ec>=85.0)
              ectemp = 8.5;
            else if(ec>=75.0)
              ectemp = 7.5;
            else if(ec>=65.0)
              ectemp = 6.5;
            else if(ec>=55.0)
              ectemp = 5.5;
            else if (ec>=45.0)  
              ectemp = 4.5;
            else if (ec>=35.0) 
               ectemp = 3.5;
            else if (ec>=25.0)  
              ectemp = 2.5;
            else if (ec>=15.0) 
               ectemp = 1.5;   
            else
               ectemp = 0.5;
        }
        else
        {
          
            if (ec>=-85.0)
              ectemp = -8.5;
            else if(ec>=75.0)
              ectemp = -7.5;
            else if(ec>=65.0)
              ectemp = -6.5;
            else if(ec>=55.0)
              ectemp = -5.5;
            else if (ec>=45.0)  
              ectemp = -4.5;
            else if (ec>=35.0) 
               ectemp = -3.5;
            else if (ec>=25.0)  
              ectemp = -2.5;
            else if (ec>=15.0) 
               ectemp = -1.5;   
            else
               ectemp = -0.5;      
        }     
     }
     //ectemp = ec > 3.0 ? 0.0 : (ec < - 3.0 ? 0.0 : (ec >= 0.0 ? (ec >= 2.0 ? 2.5: (ec >= 1.0 ? 1.5 : 0.5)) : (ec >= -1.0 ? -0.5 : (ec >= -2.0 ? -1.5 : (ec >= -3.0 ? -2.5 : 0.0) ))));
 
     ecLeftIndex = (int)((ectemp-0.5) + 10);        //[-10,10] -> [0,20]
     ecRightIndex = (int)((ectemp+0.5) + 10);
 
     ecLefttemp =ectemp == 0.0 ? 0.0:((ectemp+0.5)-ec);
     ecRighttemp=ectemp == 0.0 ? 0.0:( ec-(ectemp-0.5));
 
/*************************************反模糊*************************************/
 
 
 
 
	fuzzy_PID.Kp = (eLefttemp * ecLefttemp *  fuzzyRuleKp[ecLeftIndex][eLeftIndex]                    
					+ eLefttemp * ecRighttemp * fuzzyRuleKp[ecRightIndex][eLeftIndex]
					+ eRighttemp * ecLefttemp * fuzzyRuleKp[ecLeftIndex][eRightIndex]
					+ eRighttemp * ecRighttemp * fuzzyRuleKp[ecRightIndex][eRightIndex]);
 
	fuzzy_PID.Ki =   (eLefttemp * ecLefttemp * fuzzyRuleKi[ecLeftIndex][eLeftIndex]
					+ eLefttemp * ecRighttemp * fuzzyRuleKi[ecRightIndex][eLeftIndex]
					+ eRighttemp * ecLefttemp * fuzzyRuleKi[ecLeftIndex][eRightIndex]
					+ eRighttemp * ecRighttemp * fuzzyRuleKi[ecRightIndex][eRightIndex]);
 
	fuzzy_PID.Kd = (eLefttemp * ecLefttemp *    fuzzyRuleKd[ecLeftIndex][eLeftIndex]
					+ eLefttemp * ecRighttemp * fuzzyRuleKd[ecRightIndex][eLeftIndex]
					+ eRighttemp * ecLefttemp * fuzzyRuleKd[ecLeftIndex][eRightIndex]
					+ eRighttemp * ecRighttemp * fuzzyRuleKd[ecRightIndex][eRightIndex]);
        return fuzzy_PID;
 
}
/*仅用于按键调参,并非算法使用*/
_fuzzy_value_t Fuzzy_Value;

bool Assert_Struct_Param(float value)
{
    if(Fuzzy_Value.NL_CurrentValue == value)
      return 0;
    if(Fuzzy_Value.NM_CurrentValue == value)
      return 0;    
    if(Fuzzy_Value.NS_CurrentValue == value)
      return 0;    
    if(Fuzzy_Value.ZE_CurrentValue == value)
      return 0;
    if(Fuzzy_Value.PS_CurrentValue == value)
      return 0;
    if(Fuzzy_Value.PM_CurrentValue == value)
      return 0;    
    if(Fuzzy_Value.PL_CurrentValue == value)
      return 0;    
  
    return 1;
}

bool Assert_Param(_fuzzy_ctrl_type_t_ type)
{
        switch(type)
        {
            case NL_T:
              return Assert_Struct_Param(Fuzzy_Value.NL_CurrentValue);
              break;
            case NM_T:
              return Assert_Struct_Param(Fuzzy_Value.NM_CurrentValue);
              break;
            case NS_T:
              return Assert_Struct_Param(Fuzzy_Value.NS_CurrentValue);
              break;
            case ZE_T:
              return Assert_Struct_Param(Fuzzy_Value.ZE_CurrentValue);
              break;
            case PS_T:
              return Assert_Struct_Param(Fuzzy_Value.PS_CurrentValue);
              break;
            case PM_T:
              return Assert_Struct_Param(Fuzzy_Value.PM_CurrentValue);
              break;
            case PL_T:
              return Assert_Struct_Param(Fuzzy_Value.PL_CurrentValue);
              break;
            default:
              return 0;
        }
}


void SetFuzzyValue(_fuzzy_ctrl_type_t_ type)
{
      if (Assert_Param(type))
      {
        switch(type)
        {
            case NL_T:
              Replace(Fuzzy_Value.NL_LastValue,Fuzzy_Value.NL_CurrentValue,type);
              break;
            case NM_T:
              Replace(Fuzzy_Value.NM_LastValue,Fuzzy_Value.NM_CurrentValue,type);
              break;
            case NS_T:
              Replace(Fuzzy_Value.NS_LastValue,Fuzzy_Value.NS_CurrentValue,type);
              break;
            case ZE_T:
              Replace(Fuzzy_Value.ZE_LastValue,Fuzzy_Value.ZE_CurrentValue,type);
              break;
            case PS_T:
              Replace(Fuzzy_Value.PS_LastValue,Fuzzy_Value.PS_CurrentValue,type);
              break;
            case PM_T:
              Replace(Fuzzy_Value.PM_LastValue,Fuzzy_Value.PM_CurrentValue,type);
              break;
            case PL_T:
              Replace(Fuzzy_Value.PL_LastValue,Fuzzy_Value.PL_CurrentValue,type);
              break;
        }
      }
}

/*

*****************************************************************************************o*=*]*,************`*[*`,\o\]/O@@@@O`.......................*..................................................,]/@@OO[.................,OOO\].**[`***********************************************************************************
****************************************************************************************,o*,[*=************,[[**\]O@@/.........,]]/O@@@@@@@@O@OOOO@@@@@@@@@@@@O\]]..................................]/@@/.............................[@@OOo***********************************************************************************
************************************************************************************][`,]oOO@@@@O``=****`***[oO@O[.........=OO[[................................................................./@@/.....................................,OO@O/]/o`***************************************************************************
*********************************************************************************,[*\/O@@@@@@@@@@O=\=^***,O@@/,]`.............................................................................................................................,[@@O].**************************************************************************
************************************************************************o**.****`=O@@@@@@@@@@@@@@^*=*=\O@@OOOO`....................................................................................................................................\@@\/[]*,*******************************************************************
***************************************************************************,*`/@@@@@@@@@@@@@@@@@@\^/O@@@OO`................................................**.........................................................................................,O@@\***,`***************************************************************
************************************************************************[*,o@@@@@@@@@@@@@@@@@@@/]O@@@@/......................................*,/OOOOo[[[[[oo`*...*........................................................................................\@@O\,^*,,***********************************************************
*************************************************************************O@@@@@@@@@@@@@@@@@@@@`O@@O`..................................]]]OOO[[.........,/@/..................................................................................................\@@O],[***********************************************************
********************************************************************`[,O@@@@@@@@@@@@@@@@@@@@@@@O`................................]/OO/`............../@O`...............................................`.......................................................=@@O/\`********************************************************
********************************************************************.*@@@@@@@@@@@@@@@@@@@@@@.*.*.............................*O/[*................,O@/....................................................*]`......................................................\@@]/`******************************************************
****************************************************************.**=@@@@@@@@@@@@@@@@@@@@@/`***................................................../@O`.........................................................,o`.....................................................,@@@]]****************************************************
*****************************************************************.*@@@@@@@@@@@@@@@@@@@`.....**................................................/@O`..............................................................\\`.....................................................,@@\*,*************************************************
****************************************************************]O@@@@@@@@@@@@@@@@@/.. .....*.............................................../@/...................................................................*o].....................................................,O@@`*`**********************************************
****************************************************************O@@@@@@@@@@@@@@@/`. ........*............................................./@/.............................................]..........................\O`....................................................,\@@\**********************************************
****************************************************************\@@@@@@@@@@@@@`.........*.............................................../@O*............................................=O.............................[O\.....................................................\@@]********************************************
****************************************************************[**,o/[OO@@`.. ........**.............................................=@/`..............................................O`...............................=O\.....................................................[@@O******************************************
********************************************************************`,O@O`. .. .....*****...........................................,@@`...............................................oO..................................,O\.....................................................O@@/`***************************************
******************************************************************.*@@^...... ..........*..........................................O@[................................................,O*.....................................O\*....................................................,@@]**************************************
****************************************************************.*@@[..........*.................................................*@/..................................................@^........................................O\.....................................................\@\`,***********************************
**************************************************************.O@@*..........*.................................................,@@`*................................................./O`..........................................O\*....................................................@@\]**********************************
************************************************************,O@@`.........*...... ......................**..................../@O....................................................@^............................................*O\....................................................\@@]`,*******************************
**********************************************************,@@@\*..  ....****......*.....................**..................,@@/....................................................=O^.........................**...................,O\....................................................\@^.*******************************
********************************************************,@@O`.**.......****......*......****...*****....**.................]@@`.....................................................=/..........................*O^....................\O.....................................................\@\******************************
******************************************************,O@/`,*******..*****......*.....*****.,]`.****....................*.*@.*.....................................................=@`..........................*OO\*...................,o`....................................................,@@`****************************
*****************************************************]@@*.*****************.******..****.*`Oo...**.......**.............,@@`**.....................................................=@...........................*OOOo*....................**....................................................*=@\***************************
************************************************.***@@[***************************.******,O^*............*.*.........../@@**......................................................=@^............................,OOO\*............................................................................\@\*************************
**************************************************O@O`**.***************************..***o^**.*..................*.*,O@@@*........................................................=@..............................OO@O^.............................................................................=@\`***********************
************************************************=@@`**.********************************=O.*****......**...........*OO@@/.*.......................................................*OO..............................=O@@O..............................................................................*@O^**********************
**********************************************.O@O************************************.*O.*.***......*........*.*OOO@@/..........................................................=@[..............................,O@@O^.........................*.....................................................OO`.********************
*********************************************,@@``***********************************.*O**.***...***.*........*OOOO@@^...........................................................=@................................=O@@O^*........................*....................................................*=@`********************
****************************************....*@@[*************************************=O*************.*.....*OOOOOO@@O.**............**...........................................OO................................=OO@Oo*........................=o...................................................*.=@`**.****************
******************************************.@@.**************************************,O^*************.*...,OOOOOOO@@O**..**************..........................................*@/.................................\O@@O*.........................*\\.............................................*.**...=@^*.****************
********************************.**.*****,@@.*`.***********************************,O^*.******..******..*@OOOO@@@@@*....****..***....*......................................****=@*.........*.....................**=OO@@^...........................=O`.*..............*]]]\].......................**... =O^....****......***
*********************************.******=@@[**..********************************.*.OO*********..*****.,O@OOO@@@O@@.*********..**.*****......................................****=@*......`***...................*...*OO@@O.........................*..,O\*............./@@@@@@@`.....................*......\O`******..**...***
.....................................**O@@`**************************************.OO**********..*.**.*@@OO@@@OO@@`******..*******.....*........................................*o@**..**=o***...................\]*..oOO@O^...........................**OO**..........@@@@@@@@@@`.......................*....OO****.*****...***
....................................*.*@O****************************************=O^...*******..***,/@@@@@@OOO@@/..*****..*******..............................................*,.*...**o*.**....................o`*.=OO@@^..............................\O.........\@@@@@@@@@@@@**................*...***...,@\*..******...***
...................................../@^********..****************************.*,/.*********.*.****O@O@@@OOOO@@^..******.******.........******************...........................*.,.*.*.....................*o^.*OO@@O^**...............*............=O....*../@@@@@@@@@@@@@^................********... =@`*.************
.................................**.*@^*********..**************************.*..=@`*********.*.*.,@@@@@@OOOO@@/^*****..*.*****.........*******************......................****..*O*.*.......................,O`*=O@@@***.*................,]O\]]`**..\O.***./@@@@@@@@@@@@@@^................********.....=@**.***********
...................................*@O**********..***************.***`.*******.=OO.**************@@@@@OOOOOO@@`.*******.******.........*.**....*****....************************......*o**.*.......................=O**OO@@\**.*****.........../@@@@@@@@@\`.O^*.*=@@@@@@@@@@@@@@@@******...........*...**.*.....OO.............
.................................*=@/,..********..***************../O`*.*****..O@.*.***********,@@@@@OOOOOO@@^..***..********.........****......********************************......O^...........................*O^.,O@@O**.*****..........\@@@@@@@@@@@@\/O^*,@@@@@@@@@@@@@@@@@^.****........**.......***....=@^............
...............................*.=@O********.*******************.,/O****......,@o...****.....**@@@@@OOOOOOO@@.*.......**...*....... ...***......**..****************************...*.=O^*.****..**************......=O^*OO@@***.****.........*=@@@@@@@@@@@@@@O\.*@@@@@@@@@@@@@@@@@^*****.***..****.......***.....=O............
................................=@@.********=OO^****************.OO*****....../@*...****......*@@@OOOOOOOO@@`*......*=O^**...........****..  ........***************************...**O^**.****..**************......*\O.=O@@^...****........*,/@@@@@@@@@@@@@@@@^@@@@@@@@@@@@@@@@@@^.***.....*.....***.....**... .=@^...........
................................@@`********=OOO***************..OO^.*****.....@O............,/@@@OOOOOOOOO@O....****.O/`.**....... ..*.*...  .........*.**********************..*****O^*********............**..****.,O^*O@@O***....**......*=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^.......**.*.....**.......*... .@O`..***.....
.............................../@O*.******=O@@^***************./O`.*****.*..=@@^............=@@@OOOOOOO`.@@*....****,O^.**.... ......*..... ...**.....**********************..******=O^.**********************..****.*OO`=O@@*.**..***.......=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^.***********......*......*.. ..,@^**........
.............................*.@@^******.=OO@.****************=O`...*.**.*.O@@@^.........*.,@@@OOOOOO/..,@o.**.*.*..O^*.**.....................*.....************......******=^*.*..=O*.**********************.......**@^,\@@*.*********....*=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@`*************.....*... ..**.. ..@O..........
............................../@.********OO@O`*************.*=@^*.**.....*OOO@O..........*.@@@OOOOO/`...@@`.**.*.../O^*............**...... ........*************************\^.*..*OO************************.........OO`,@@^.*************.=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\**************.....**.. ...*.....=@^.........
..............................@@^*******OO@@.************...=@O...***..*O@oOO@^.........*./@@OOOOO`.....@^*......*.@^**.*..... .....***.........*****************************=^**.*=O^..********************.**.....*.**@^*=@^..**************\@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\`*******..****....**......*.... .@^.........
.............................=@O*****.*oO@@O************.**,@O.*...***,@@\oOO@^..........=@@OOOO[......@@^......**,@^............*.****....***..............................*=^....=@^......*********.********.......**.OO*=@^*.**************=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O*.***..******..****......**.....OO.........
.............................=@^*****.*OO@@*************..*OO...*....*@OOoOO@@^.........*@@OOOO*.......@O*.......*=@^.*.........************................................*=^....=@^.*.....******************... ...**=@*=@^*******...*.**.**@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@^*******..***********...........=@.........
............................,@@******=O@@@[***********..../@`......,@@OOOoOO@@^.........=@@OO/........=@^*........=@`........................................................=\..*.=@*........*.************.........***=@^*@^*******...*.**.**O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O*.*****..**********.****.*.... .@\........
............................=@^^*****O@@@O.*********.**.*\@^..****=@@OOOooOO@@^.........@@OO*........./@^.........=@*........................................................=\..*.=@.........**************.....  ..*.*,OO*@@*******..****.****@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@***************************.....@O........
............................=@^****.*OO@@`.*************,@.***...*@OOOOOooOO@@^........=@@/...........@@*.........=O*........................................................=O***,O@.........**************.....  .....*=@*@@^.*****..*********[@@@@@@@@@@@@@@@@@OO@@@@@@@@@@@@@@@@@****************************....O@........
............................=@`***.=OO@@.************.**@O*.*..*O@OOOOOO\/O[OO*........=@/...........=@^**......../O................................................****.....=O*..=@@*..................****............*=@`@@^*************..*..\@@@@@@@@@@@@@@@O@@@@O@@@@@@@@@@@@@@`****************************...=@.*......
............................O@****,OO@@@^************../@^.*...@@OOOOOOO\]]./@\]]]*...=@@............=@^..........=O................................................****.....=O^*,O@@...................****.............=OO@@^.********.......***\@@@@@@@@@@@@@.*O@OOO@@O*\@@@@@@@@^..*************************.***.=@^.......
...........................*@@.***oOO@@^*************.\@O.*.*\@@OOOOOOOO[*..=@^*[OOO@@@@@@\/]........=@^.......*..,[....................................********............*=@^*O@@@.......................****......*..*O@@@^.....********..****.@@@@@@@@@@@@^*.=@@O@O@@O`**,[OO^*****....********************.*...=@^.......
...........................*@@...=O@@@@^************..*@...*=@@OOOOOO/....../@^.*...../@[[\@@@OOOO`..@@*.......*\.......................................*********..***......*=O^=@O@@.......................*****.......*.=@@@^.....********..*****,\@@@@@@@@@,.**,@OOOOO@@\`****.*******************************.***=@^.......
...........................=@@***=OO@@^**********.*..*@^..=,@@OOOOO.*.......=@^*.....=@*......,@@O/\O@@.......=OO...............................................*.*=OO^*.....=@^OOO@@*...................................*=@@@^......**.....*****..**O@@@@@@,[*****@OoOO@@@@O****************************************=@O.......
...........................=@@***OOO@@^*********.**.=@O.*..@@OOOOO`..........@^*...../@...........\@@@@/o*...=OOO................................................*.OOOO......=@O@OO@@..*..................................=@@@^......**.....****.******\O.****.*.*.O@^=OOOOO@\***************************************=@@.......
...........................*O@**oO@@@@************..*@`.**@@OOOO/............@O*....*@/.............=@@OoO].*OOOO*................................................=OO@O*.....O@@OOO@@*..........********..................=@@@^......**.......******************.**\@^*\OOOO@@^**************************************=@@.......
............................=@**oO@@@O************.*@O..,@@OOOO[.............\@^....,@*.............=@O.[O@\/OO@O.................................................OOOOOo.....=@@OOO@@*..................................*.*@@@^*.....**.......*********.************@^**\O@O@@@`**************************************O@.......
............................=@/=OOO@@O**********...*@^..@@OOO/................@O*...OO*.............=@^...,O@@OOO\...............................................=OO@OOo....*=@@OOO@@*..............*.....................*@@@^...............*******...**********.*@^***=OOO@@@`*************************************=@.......
............................=@^*O@@@@^*.********..*@O*.O@OOO^.................=@*..*@/..............=@/..*./O@OOOO..............................................*OO@@OOO^...*=@@OOO@@^..............*.....................=@@@^*.....**.......********************.*@@^***=OOO@@O*.***********************************=@.......
............................=@O=O@O@@**.**********=@^*=@@OO`...................@O.**@^..............=@^...,OOOOOO@O.............................................=O@@@@OO^....=@@OOO@@\..............o*..................*.=@@@^*........****..**********************@@^****oO@O@@o.***********************************=@*......
.............................\@oOO@@@**.........*.@@^=@@O^...............=\`...=@`*OO`..............=@^...=OOOOOO@@`............................................\OO@@@OO^....=@@OOOO@O..............O^...................*=@@@^.........****..**********************@@^*****oOO@@@`***********************************=@*......
.............................=OOO@O@@`********..*,@^,@@@o.........../@@@@@@@\...\@.@^....\\.........=@^*../OOOOOOO@\*..........................................=OOO@@OOOO...*=@@OOOO@@*.............O^....................=@@@................********......********@@^******\O@O@\*******************************.***=@*......
..............................@@@OO@@^..******...=@^@@@@.......\@@@@@@@@@@@@@@@`.\OO^......O@\......=@O..*O@OOOOO@O@O.*........................................=OOO@@OOOO*..*=@@OOOO@@^.............O^...................*O@@@................********......********@@^*******\O@O@^******************************.***=@*......
..............................\@@@O@@/.*........*=@@@@@`........@@@@@@@@@@@@@@@@@@@O*........\@@]...=@.*.*OOOOOO@@/,@^.........................................=O@O@@@@@O*...=@@OOOOO@^**...........@O*..................*OO@O................********......********@@^********oO@@@^**.****..***************...**.***=@.......
...............................O@@@@@^**.........O@@@@@......../@@@@@@@@@@@@@@@@@@@@@\.........\@@O`.OO.**OOOOOO@O..=@^.............................*.*OOOOOO`.=O@O@@@@@O*...=@@OOOOO@@`*...........@O.*.................*O@@^................********......********@O^*********\OO@O**.......********************.***=@.......
...............................,@@O@@@****...****@@@@@O........@@@@@@@@@@@@@@@@@@@@@@@@@.......=O@@@OOO*.=OOOOO@@^...=@\................................*=OOo[\@@@@@@@OOO^...=@@OOOOO@@^.*..*.......@O...................=O@@^*...............**********************@O***********OO@@`******..************************=@.......
................................\@@O@@^.**..**..*@@O@@^.......=@@@OO/\/\@@@@@@@@@@@@@@@@@\`.....\OO@@@@^.=OOO@O@O.....\@*..................................*,O@@@@@@@@OOO^...=@OOOOOOO@O*...........@@*..................*O@@^................**********************@O************OO@@*.****..**************.=O^******=@.......
.................................O@@@@^`**.**..**@@O@@........=@@^.....@@@@@@@@@@@@@@@@@@@@\`...\OOOO@@^.=OO@O@@^......\@`.*...................................O@@@@@@@@O^...=@OOOoOOO@@^...........@@^.................*OO@@*................**********************@O***********.,O@@o.......**************,@O^***.**=@.......
.................................,@@O@@^*........@@O@/........@@@`....,@@@@@@@@@@@@@@@@@@@@@@@..=OOOOO@^*,OOO@@@........\@`....................................OOO@@@@@@@@^../@OOO*\OOO@O...........O@O.................*OO@@.................**********************@^**********.**\O@@*......*************.O@O\******=@.......
..................................=@@@@@^.*.*..*.@@@@^........\@^...../@@@@@@@@@@@@@@^..\@@@@@@\*[\OO`\O^=OOOO@^.........\@^*..*...............................O@O@@@@@@@OOO]@@OO`.*oOO@@`..........O@O..............*..=O@@O.................**********..**********@^**************O@@^*...***************O@@O^***.*.=@*......
.................................=@@@@@@O*..****.@@@@.........,@O.....@@@@@@@@@@@@@@^   .O@@@@@@O......O^*OO@@@^..........=@\.*................................O@@@@@@@@OO@OO@@O/...,OOO@@..........O@O*...............*OO@@^*................**********..********./@^**************=O@O*****************.=@@OO^***.*.=@.......
................................./@@@@@@@O..****.@@@^..........=/.....@@@@@@@@@@@@@@^  ..,O@@@@@.......,O`OO@@@^............@O................................*O@@@@@O@@O**,\@@@\....=OO@@^.........O@O^...............=OO@@**................**********..*******.*O@^***************O@@^*****************=@@OO^******=@.......
................................=@@OO@@@@@]`****.\@@^.................@@@@@O@@@@@@@@^.. ...O.=@O........O\=O@@O..............\@\..*...........................*O@@@@@O@O^..*=@@@@@`...oOO@@.........O@OO..............*OO@@@*.................**********..*********O@^***************=@@\*****************O@@OO^******=/.......
................................@@@O@O@@@@@`**.*.=@@^..........,*.....@@@@@@@@@@@@@@@\]@@/...,[*.........O*OO@^...............=@O*.............................oO@@@OOOO^.*=@@^..@@@..\OO@@O`*......O@OO*.............=OO@@^................**..*******************@O`***************,O@O****************.O@@OO^******=^.......
...............................@@@OO@@@@@@@@\****,@@..............*...,@@..,[oO@@@@@@@@@@.................^=O@^.................\@\,...........................=@@@O@@OO*..=@O.....\@@`=OO@@\*......=@OO^............*oOO@@.................**......**************=@O`****************=@^*****************O@@OO^*****=O^.......
.............................,@@@O@@@@OOO@@@@O]***@@^...................*...*,``oO@@@@@@^................../=@O...................O@\..................O@@@\]..=@@@@@@Oo*.*O@........\@@OOO@\.......=@OOO*...........=OO@@O...**..........****....**************.*=@O^.***************,OO**.**************O@@OO***..*=O^.......
............................,O@@O@@@@@OO@OO@@@OO`*=@^......................=@@O\`=\@@@@`....................=OO`...................,\@\..................]]O@@@@@@@OO@O/..*@^..........,@@O@@^......=@OOO*.........*]OO@@@*.**............****....****************=@O^*****************o.*****************O@@OO^*****=@^.......
............................O@@@@@@@OOOOOOO@@@@@@@O@@`.......................,@@^**O@@.......................=o.......................\@@]........../@@@@O[[*..=@O@@@@O`..=@.............=@@@@^.....=@@OO^.........*=OO@@O..****.......*`..***..******.***********O@oO`****************,**.***************O@@OO^*****=@`.......
..........................,O\@@O@@@@OOOOOOO@O@O@@/[\@^..........................*.............................*.........................,O@O].......=O..,\OO..=O....@@@@O`@^...............O@@@`....=@@OO\........**OOO@@^..**.........OO.*.**..*****************=@O*O^***********************************O@@@O^****.*@........
.........................=O^O@@@@OOOOOOOOOOO@O@@O..........................................................................................,O@\]**..//.O@@@@@@@O`...=OO.[OO`................=@@@..*.=@@@OO*.......*OOOO@O*........****=@**..**********=O^.*****.,=@.*OO`*********************************.O@@@Oo****,O@........
........................=O`=@@OO@OOOOOOOOOOOO@@@...............................................................................................[OO\]O^./@@@@@@@@@@@\`.\\.o...................O@@@^..,@@OOO^......./O@O@@^........*...=@.**..********.*OO^.*****.*=@***O\**********************************O@@OOO****=@O........
.......................//`*O@*,O@OO@OOOOOOOOO@@^...................................................................................................*`.*@@@@@@@@@@@@@@@@OO^....................\@@O\**O@OOO^..*...=O@O@@/....****.*.**@O*....*********OOO^*****..=@@***=O**********************************O@@OOO**.*=@^........
.....................=@O,*=@/.*=OOOOOOOOOOOO@@^...................................................................................................../@@@@@@@@@@@@@@@@@@@@\]...................O@@/O\=@@OO^.*...,OOOO@@^********....OO`*************,OOO^*******=@O***=O\*********************************o@@OOO****=@.........
....................=@/,=,O@**.*=OOOOOO@O@O@@O*......................................................................................................@@/OO@@@@@@@@@@@@@@@@@@@@\................*O@@`\O@@@OO*...=OOOOO@^.*****..**.*O@^.*************=OOO*****.**=@o****=@*********************************,@@OOO^***=O.........
...................O@^..*O@O*****OO@OOO@O@@@@^.........................................................................................................o/[.@@@@@@@@@@@@@@@@@@@@@@@`.............=O@@`=@@@OO^..*OOOOO@@`**..**..***O@.***************=OOO*****.**O@*,***,OO.********************************@@@OO\***=O.........
.................,@.*./O^O@^******oO@OOOOO@@/............................................................................................................./@@@@@@@@@@@@@@@@@@@@@@@@@@]...........oO@O/@@@OO^*.*OOOO@@O.**...*..**O@.*.***********.*=OOOo********@@o*****=@^`*******************************O@@@OO*..=O.........
................/@^.*O/..@O^******,OOOOOOO@@.............................................................................................................=@@@@@@@@@@@@@@@@@@@@@@@@@@@@@\`........,OO@OO@@@@O*oO@O@@@@****...**.,/@`********.......*=@OO^******.=@@Oo****,OO********************************,@@O@O^..=@.........
..............,@@*]O/...=@^*********oO@O@@@^.............................................................................................................=@@@@@@@@@@@@@@@@@@@@@@[@@@@@@@@@`.......\OO@@@@@OOOOO@O@@@^.****..*.,OO******************o@OO^*******=@@@@\****=@^********************************@@@@O^**=@.........
............./@^]O/.....O@^.*********\OOO@@..............................................................................................................=@@@@@@@@@@@@@@@@@@@@^...=@O@@@@@@\......*OOO@@@@@OOOO@O@@@.*****..*=@.*******************O@OO^******.*@@OO@\****OO^*******************************=@@OOO**=@.........
...........,@O/O`.......@^************=O@@^.................................................`............................................................=@@@@@@@@@@@@@@@@@@@@.   .OO@@@@@@@^......=OOO@@O@@OOO@@@@^*****..*O@/,*****=o************O@OO^*******O@@OOO@\,***@O*.******************************@@@@O^*=O^........
.........,@@O@^........=@^**************O@*...............................................=O@`...........................................................=@@OOOOO@@@@@@@@@@@@@. .  .,O@@@@@@@^.....*oOO@@@OOOO@OOO^.******,@@`******,O.***********=@@OO^******=@@OO@OO@\.**[@^******************************=O@@OOO^=OO........
........=@O@/..........=@O**************=@................................................,O`............................................................,@^...*\]oO@@@@@@@@@@@@@@.....,O@O@@@`.....=OO@@@OO@O@O@O******,O@O********^@^***********=@@@O^*******@@@OOOO@@\***O@*`****************************==@@@@@^*O@........
.......O@@`............@@***************=@......................................................................................................................*****\@@@@@@@@@@@@.......,\@@@^.....=OO@@@@OOOO@@^.***./@.**********@@^***********=OO@O^******=@@O@OOOO@@O`,=@\*******************************=@@@@O^O@........
....,@O/...............@@***************=@`...................................................................................................................=@@\*=**=@@@@@@@@@@..........\@@^.....=OOO@@@OOOO@O**.`/@O.**********=@O********`****OOOO^******=@@@OOOOOO@@O*.=@^*******************************O@@@@O/@^.......
.../@@^...............=@O***************=O\.....................................................................................................................[@@@\=^\@@@@@@@`............@@`.....*OOO@@OOO@@@`*,O@O*.**********.@@^*******=^**==@OOO^******=@@@OOOOOOOO@O^,O@*******************************=@@@@@O@@.......
.=@@[.................=@O.***************=@......................................................................................................................*,\/`**O@@@@`............./@`......*OOOOOO@O@@^,O@/.*************O@O^*******=\***=@@OO*******O@@OOOOOOOO@@@@`\@O*.*****************************\@@@O@@@O......
/@^...................=@O****************=@^..............................................................................................................................................O/........*oOoO@@@@@@@@^***************=@@o********=O***=@@OO^******@@@OOOOOOOOO@O@@^\@^*****************************.*@@@OO@@@^.....
/.....................=@o*****************OO............................................................................................................................................`............=OOO@@@@@O`*[**************,@@O^********=O***=@@OO^******@@@OOOOOOOOO@@@@@o@@.******************************,@@@@@@@O]....
......................=@.*****************=@\.........................................................................................................................................[.[*..........*OOOO@@@/.**.**************=@@O.**********OO**=@@OO^******@@@@@OOOOOOOOO@O@@\@O`******************************,@@@@@@OO\...
......................=@o***************.**\@^.......................................................................................................................................................O@@@.****,OO`************`/@OO`**********OO***O@OO^******@@@@OOOOOOOOOOOOO@@O@O`******************************o@@@@@@OO\..
......................=@o******************=oO`....................................................................................................................................................]@@O`*,,oOO[**************.*@@O`***********=O`=*O@@OO******@@@@OOOOOOOOOOOOOO@@@@O\`****************************.*@@@@@@/\O.
......................=@^********************=@^................................................................................................................................................,@@/^.,]/@@.****************,O@OO^************=O^**=@@OO^*****@@@@@@OOOOOOOOOOOOO@@@@OO^****************************`O@@O@@^*\O
......................=@^*********************=@\............................................................................................................................................]@@@[.*\/@@@^,*****************O@@Oo**************O^*.=@@OOo*****@@@OOOOOOOOOOOOOOO@@@@@@@OO^****************************,@@@@@\`\
......................=@\**********************o@@............................../@@@@@@@@@@@]............................................................................................],O@@`**,O@@O@@O.,***************.O@@O.***************OO^*=@@OOO*****O@@@@@@@@@@@@OOOOO@@@@@@@@OO\****************************=@@@@@*,
......................=@@`**********************O@@`...........................=@@@@@@@@@@@@@@@@@`.....................................................................................]O@/`*,/@@/.,O@@`******************=@@O/,***************,O^*=@@O@O**,**O@@@@@@@@@@@@@@@@@@@@@O@@@@@OO\`*************************,[O@@@O,
.....................,O@@^**********************\@@@O..........................@@@@@@@@@@@@@@@@@@@@@O]........................................................................../\],]]O/`]/@@O[....*@@^.*****************=@@OO******************OO^*\@OOOo****O@@@@@@@@@O`*.....[\O@@@@@@@@@OOO`************************`*\@@@\
................]]OO[=@O@^**********************oO@O@@`........................@@@@@@@@@@@@@@@@@@@@@@@@@O`....................................................................`//oOo/\]@@O[*.....*O@O*******************=@@OO^*******************@^*=@@O@O`***O@@@@@@O`...............,\@@@@@@@OO\***********************,`o@@@
............/@O[`...=@o=@@**********************=O@@O@@\.......................@@@@@OO@@@@@@O@OO@@@@@@@@@@@O.................................................................,O@@OO@@@.****.....=O@^*****************.*]@@@O*********************o@`=@@@@Oo**==@@@@O`....................,@@@@@@@@@Oo^*,*******************\oO@
.......,/@@[`......,@O*^O@^*********************=O@O@@@@@`.....................@@OOOOOOOOOOOO@OOO@O@@@@@@@@@@@\`.........................................................,/@@@@@O/\o******...../@@`*******************,@@@O^**********************OO*O@@OOO^*=,@@O`.......................=@@`.[\@@@@OOOo]**************`***`*\
.....*@O*.........,@O`***@@`********************=O@O@@@@@@\....................=@@@OOOOOOOOOOOOOO@@@@OOO@@@@@@@@@\.....................................................]@@@@.***=^**...*..*..,O@O**,]***********.****=@@@O^***********************\@O=@@O@OO***OO..........................=@O^.....[@@@@@OO][*,[`*,***********
../@O`...........]@^****,o@^*******************.*O@@@@@@@@@@]...................=@@OO@@OOOOOOOOOOOOO@@OOO@O@@@@@@@@\.............................................../@@@@@.*.**.*............*@@^.*@O[***************,@@@O.*************************o@O@@@@@O\***\...........................O@O^........[@@@@@OOO`,[***********
OO`.............=@.******O@^*******************.*@O@@@@@O@O@@@`..................@@@@@@@OOOOOOOOOOOOOOOOOOOOOO@@@@@@@\..........................................]@@@@@O`.................*=@@O.*@@O^***************,@@@@O`**************************=@O@@O@OO^*=@^..........................=@OO^..........*\@@@@@OO\**,***,***
*............../@`...***OO@O`******************=OO@@OOOOO@@@@@@\.................,@@OOOOOOOOOOOOOOOOOOOOOOOOO@OOO@@@@@@......................................./@@@@@O`..................=O@@`O@@@@/`************.*,O@@@O^****************************O@@@@@@OO^=O@...........................\OOO`.............,\@@@@O]********
.............,@@`....**OOoO@******.************=O@@OOOOOOOOO@OO@@`.................O@@OOOOOOOOOOOOOOOOOOOOOOOOOOO@O@@@@^....................................]@@@@@@`..................,O@@OO@@O@@O.**************.*@@O@.*****************************oO@@@@O@@O*O@*.*........................=O\O\.................,O@@@Oo*]]`*
............@@/.....*,OO\*=@******...**********OO@OOOOOOOOOO@OO@@@@..................,\OOOOOOOOOOOOOOOOOOOOOOOOOOOOO@@^...................................,@@@@@@`..................,oO@@/@@OOO@@O^*************.*@@O@O^*****************************=^=@@OO@@@Oo@O..*........................@^=@`....................[O@@@@@@
........../@O*.....,/O/[*,=@`****....********.*OOOOOOOOO@@@@O@@@@@@@\...................[OO@OO@@OO@OOOOOOOOOOOOO@O@@@`...................................=@@@@@@..................,OO@@O@@OOOO@@@O**********.****@@@@OO^********************************o@@@@@@OO=@....*......................O^,OO......................,@@@@@
........=@@o`*...,@@/.....=@*****....********=OOOOOOOOOOOOO@OOO@@@@@@@`.....................[\OO@@@@OOOOOOOOOOO@@@@`.........,]]*......................./@@O@@/..................*O@@O@@@OOOOO@@OO**************@@@@@@O^********************************`/\@@@@@OO@\....**....................O\^=O^...................*O@@@@@@
....`,@@O`\]\]./@@/......*=@.***.....********oO@@@@@OOOOOOOOO@@@@@@@@@@\..........................,[[[[\@@@@@[[[`......=/O/[[[.....*...................O@@@@@^................,oOO@@\@@OOOOOO@@@@O********..*.*=@@@@@Oo*********************************`[*O@@O@@O@@^....**...................OO^*\O.................,O@@@@@@/.
..]O@O/,*,.*.@@O[.......*,=@****.....*******=O@@@@@@@@@O@@@@@@@@@@@@@@@@@\.....................................]]O@@O[..............*[o]............../@@@@@^...............oOOO@@O/@@OO@@O@@@@@@O*************@@@@O@O^**************************,`*******`*=@@@@@@@\.......*.................=O^*=O`............../O@@@@@@`...
@@O[^*,ooO@@O[^*.......*,*\@^***.....******=OOO@@OO@@@@@@@@O@@@@@@@@@@@@@@@.............................]]/@@@@[........................,\\`........./@@@@@^.............,OOOOO@@O/@@@@@OOOOO@@@@O************=@@@O@@O^**************************o\*********o`\@@@@@@^.........**.............=O^*=O^...........]O@@@@@@O`.....
[o[/O\O@@O`,[`****..****,*O@***.....**....*O@@O@@OO@@@@@@@@@O@@@@@@@@@@@@@@@\...................]/@@@@O[[`.................................,\O].....,@@@@@@..........,]OOOOOOO@@o@@@@OOOOOO@@@@O@O************@@@@@@@O`*************************`\O^********`*,o\@@@@@`........................@^**OO........]O@@@@@@@`........
oO@@@@Oooo`***************O@***.....*.....O@@@@@@O@@@@@@@@@O@@@@@@@@@@@@@@@@@@^........]OO@@OO[[[`.............................................[O\`,@@@@@@.........,/OOOOOOOO@@/@@OOOOOOO@@@@@@O@O***********\@@@@@@@O****************************oo\`*,******=o\=@@@@\.............**.........@^**OO....,/O@@@@@@@[...........
@@@@^,`=*****************=@O***.....*....=O@@@@@O@@@@@O@@@@@@@@@@@@@@@@@@@@@@@@@/OO[[`.............................................................@@@@@@^......*oO\OOOO@@@@@@`O@@OOOOO@@@@@@@@O@O***********=@@@@@@@O***************************`oOo*=*********`[*,@@@`..............***......@^**O@]]O@@@@@@@@...............
@@O^****^****************=@.***.....*....OO@@@@@O@@@@@@O@O@@@@@@@@@@@@@@@@@@@@@@[...........................*]]]`.................................=@@@@@@O\]OOOOOOOO@@@@@OO@@O=@@O@@@@@@@@@@@@@@@O**********,@@@@@@@OO**************o^*****,*****=*OO``,************`*O@@\................**...@^**=@@@@@@@@O`.................
Ooooo`*,^****************O@^***.....*...=O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@.........................]/OOOO@O`................................./@@@@@/,[@@@@@@@OOOOOOOOO@O=@@@OO@@@@@@@@@@@@@@O^********,=@@@@@@@OO*****************]/[**]]]]^=`=OO//]]]]********`,oo/@@@]................*,@^**O@@@@[*.....................
o**oo***********`********@O^***....**../O@OO@O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@/`....................]/OOO@@@O[....................................=@@@@@@^....,\@@@/ooOO@@@@@o@@OOO@@@@@@@@@@@@@@@O\`********=@@@@@@@@O**********oooo*oo**.*[*=^******OO`=^,^****o*******=Ooo@@\`............/O@@o*`=O.......................,`.
o\/oo************o*,/OOO@@.*****.**.*OO@@@@@O@@@@@@@@@@@@@@O.........O@@@@@@@@OOO@@@OOOOOO@@@@@@@@@O/[`*.........................................=@@@@@@.........,[@@@@@OO@/=@@O@@@@@@@@@@@@@@@@@OO\********=@O@@@@@@O**********oooo*oo*....*=^****.*,OOo,oo****o*******oOO^=^\@@@]*...*]/O@@O@@^^=o/...................../O@O.
oooo`**********.*OOO@@@@@@^*******.*O@O@@@@@@@@@@@@O@@@@@@O*......./OO`..........................................................................=@@@@@O.............,\O@@@[@@@@@@@@@@@@@@@@@@@@@OO`********=@@@@@@@@O*********.*ooooo**....*\`ooo*o=^=OO/\o**=ooo*oo***.*O@O*,*][\@@O`.......OO^*=@^................../OO@@O..
ooooooo]o`*,]]OOO@@@@@@@@O`*******oOO@@@@@@@O@O@@@@@@@@@@/......,O@`.............................................................................O@@@O@^.................@O=@@@@@@@@@@@@@@@@@@@@@@Oo********=@@@@@@@@O**********oooooooo^....*\ooo*o/.*oO@\,**=ooo*oo***`*`,OO`*^***[[@@@]`...@.*.*O................,OO@@@O`...
oooo\]/oo\/OO@@@@@@@@@@@@^*,****=OO@@@@@@@@@@@@@@@O@@@@.*.....,@@`...............................................................................=@@OO@^.................@^O@/=O@@@@@@@@@@@@@@@@@@@Oo^******=@@@@@@@@O^*****[[[[*=oooooo\*....*ooooooooooO@O\]=oooo\[`*,oooooO@Oooo\,[**=O@@@]@^]=O^.............,/@@@@@O^.....
oooooooo/O@@@@@@@@@@@@@@O,*`***,O@@@@@@@@@OO@@@@@@@@@/......,@@`.................................................................................=@@@@@^.................@^O@....,\@@@@@@@@@@@@@@@@Oo*,o`**.*@@@@@@@@O`*]]]]oooooo*..=oo/^.....*oooooooo,oO@OoOOOOOOOo]*oooo^*\O@OOO]`*[`***[O@@@O^..........*,oO@@@@@OOOO@@@@@
oo/oooOO@@@@@@@@@@@@@@@O*****,OO@@@@@@@@@@O@@@@@@O[......../@^...................................................................................=@@@@@O.................@^@@........\@@@@@@@@@@@@@@O^/oooooO@@@@@@@@O^*ooooooooo^....,oo^^.....*=oooooooooO@@OO@@@@@@@OOO]]o]**\@\,[O@O]]*[[***\O@@@]`....]OOO@@@@@O[[[*......
oooOO@@@@@@@@@@@@@@@@@o****]/O@@@@@@@@@@@@@@@@/..........,@/......................................................................................\@@@@@................*@O@O............[O@@@@@@@@@OO^*ooooo@@@@@@@@OO^oooooo/[o`*....*oo\`.....*oo*,oooooOO@@OO@@@@@@@@@@OOO]o=oO@\...,O@@@],`**`.*O@@@@@O.*.*...............
oOO@@@@@@@@@@@@@@@@@@o.**.*OO@@@@@@O@@O@@@[.............OO`........................................................................................@@@@@^...............*@O@O................[\@@@@@@Oo***=o,O@@@@@@@@Ooooo*o\****=*....,/=o^....*=oooooooooOO@@OOOO@@@@@@@@@@@OO\=o@@@O\@@@O@@@@o]/`.*],O@@\...*..............
O@@@@@@@@@@@@@@@@@@/[o^=oOO@@@@@@@@O@@@@`.............=@/...............*,]]]`****..................................................................@@@@@`...............OO@^..................=@@@@@@Ooo^*\\=@@@@@@@@O\*,oooo^...*=.....=ooo\*..=oooooooooo\OO@@@^OO@@@@@@@@@@@@@OOo[@O`=O/oO^.[\@@O`,o[],]O@\................
@@@@@@@@@@@@@@@@Ooooo/oOO@@@@@@@@@@@@/..............,@@`..............*OOOOOOOOOOOOOOOOOOOOOo]]]]]`*.................................................\@@@@`..............OO@^...................=@@@@@@Oo`[,oo@@@@@@@@@Oo\o=ooo*...=o*...*o\oo\].*ooooooooooooo@@@@\oOO@@@@@@@@@@@@@OOOO@@OO@^......,@@\]\\==`O@O*.............
@@@@@@@@@@@@@@O^oooooOO@@@@@@@@@@O`................@@^..............,OOO@@@@@@@@@OOOOOOOOOOOOOOOOOOOOOOOoo]]...............................**,]]]]OOOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OOOOOO]]@@@@@@@OooOo^@@@@@@@@@Oo/oooooo\*..*o\`]]/ooooooooooooooooooooO@@@@@ooO@@@@@@@@@@@@@@@OOo@@...........[O@Oo[o^,Oo^............
@@@@@@@@@@@@Oo\o[[oOO@@@@@@@O/`.................,@@/..............,/OO@@OO\*...[[[O@@@@@@OOOOOOOOOOOOOOOOOOOOOo]...............**,]/OOO@@@@@@@@@@@@@@@OOOOOOOO[[[[[[[[[[[[[[[[[O[OOOOOOOOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O\/ooooooo]]]ooo\oooooooooooooooooooooooOO@@@@O/oO@@@@@@@@@@@@@@@@OO@^............[@@Oo^ooOO`..........
@@@@@@@@@@O/=OooOO@@@@@O[`....................]@@`..............,OOO@@/....[OO]`.......,[[\@@@@@@@OOOOOOOOOOOOOOOO\]]]]]]OO@@@@@@@@@@@OOOO[[`........................................................,[[[[[OOOOO@@@@@@@@@@@@@@@@OOOOOOOooooooooooooooooooooooooooO@@@@@@/OOO@@@@@@@@@@@@@@@OOO@`.............\@Oo,oO@`.........
@@@@@@@@OooOO@@@@@[........................]/O/..............,oOOO@@/.........,O@\`..............,[OO@OO@@OOO@@@@@@@@@@@@OOO[[[*.......................................................................................[[[[[\OOO@@@@@@@@@@@OOOOOOOOoooooooooooooooO@@@@@@@OOO@@@@@@@@@@@@@@@@@O@O`.............,OOooO@`........
@@@@@@oO@@@[[`........................../@/`..............*.OOOO@@[..............,\@\`.............*]]/O@@@@@@@@OO/[...................................................................................................................*[[[\OOOOOOOO@@@@@@OOOOOOOooOO@@@@@@O/O@@@@@@@@@@@@@@@@@OO@\..............\O@OOO].......
@@@@O@O/..............................,@/..............,/OOOO@@@[...................,@@].....*]]O@@@@@@@OO[*.........................................................................................................................................,[[[OOOO@@@@@@@@@@@@@@@@OO@@@@@@@@@@@@@@@@@@O@@`..............,OOO@\....,]
@@@@/.................................OO............,/OOOOO@@@`........................\@OOO@@@@@@O[[..........................................................................................................................................................,[\O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OO@^......,]]]O@@@@@@@@@@@@@@
@/.....................................OO......*ooOOOOOO@@@@\.......................*]O@@@@@O/`........................................................................................................................................................................,[\O@@@@@@@@@@@@@@@@@@@@@@@@OO@@@@@@[[[[[...............
]]]]]]]]]]]*............................,O@@@OOOOO@@@@@[`...,\@@\]...............,/@@@@@O[......................................................................................................................................................................................[[O@@@@@@@@@@@@@@@OO[[.........................
OOOOOOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OOO]]]]]]]]]]]]]]]]]/@@]]]]]....]/@@@@@O[................................................................................................................................................................................................*[\O@@@@@@@@OOOOoo]]]*...................
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@OOOOOOOOOOOOOOOOOOOOOOO@@@@@@@@@@@@@@O[............................................................................................................................................................................................................[O@@@@@@@@@@@OOOOO]]`............
@@@@@@@@@@@@OO@@OOO@@OOOOOOOO@@OOOOOO@@@@@O@O@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O.*...................................................................................................................................................................................................................[OO@@@@@@@@@@@OOOOOo]*......
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O@@@@@@@@O@@@@@O@@@@@@@@@@@@@@@@@@@@@@@@@OOOOOOOOOOOOOOo]]]*.*......................................................................................................................................................................................................,\O@@@@@@@@@@@@@OOOO\]*
@@@@@@O**[[[[OOOOO@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@O[`..................,[[OO@@@@@@@@@@@@@@@@O@OOOOOO\]*.................................................................................................................................................................................................[[O@@@@@@@@@@@@@@O
@@@@@@@O.................,[[OO@@@@@@@@@@@@@@@@@@@@@O/...............................*,[[OOO@@@@@@@@@@@@@@OOOO\*...................................................................................................................................................................................................[O@@@@@@@@@@@
@@@@@@@@@`........................*[\O@@@@@@@@@@@O`..**,*******...............................,[OO@@@@@@@@@@@OO/......................................................................................................................................................................................................,\O@@@@@@
@@@@@@@@@@^..............................,[O@@@@@@@@@@@@@OOOOOOOOOo\`*...............................[\OOO@@OOO^..........................................................................................................................................................................................................,\O@@
@@@@@@@@@@@^...................................,\@@@@@@@@@@@@@@@@@@OOOOOO]*....................................................................................................................................................................................................................................................
@@@@@@@@@@@@`.......................................,[O@@@@@@@@@@@@@@@@@@@OOO\`................................................................................................................................................................................................................................................
@@@@@@@@@@@@O............................................[\@@@@@@@@@@@@@@@@@@@Oo`..............................................................................................................................................................................................................................................
@@@@@@@@@@@@@O...............................................,[@@@@@@@@@@@@@@@@@OO*............................................................................................................................................................................................................................................


@      .----.                                  .-.                       
         /   `                      .-.  .--.-'             .-.      .-. 
        /  .-.   )  ( .  .-. .-.    `-' (  (_).-.  .-.      `-' ).--.`-' 
       /      )_(    ) )/   )   )  /`-=-.`-. (  | (   )    /   /    /    
      /    (   ) `--':'/   /   (_.(__. _    ) `-'-'`-/-'_.(__./  _.(__.  
 .---------'`-'                 `-'   (_.--'     -._/                    


*/

#if 0
float speed_pid()
{
        float tar = 0,cur = 0;                //目标值 , 实际值
	static pid_ctrl_t pid= {0, 0, 0};              //赋予初值kp，ki，kd
	static int sumE = 0;                   //累加偏差
	static int lastE = 0;
 
	pid_ctrl_t OUT = {0, 0, 0};
	float e = -1,ec = -2.6;
 
 
 
	e = tar - cur;             //目标值 - 实际值
	ec = e - lastE;            //误差变化率
	sumE += e;
	lastE = (int) e;
	OUT = fuzzy(e, ec);      //模糊控制调整  kp，ki，kd
 
	return (pid.Kp+OUT.Kp)*e + (pid.Kd+OUT.Kd)*ec + (pid.Ki+OUT.Ki)*sumE;
}
#endif

//static const _fuzzy_rules_t fuzzyRuleKp[7][7]={
//	PL,	PL,	PM,	PM,	PS,	PS,	ZE,
//	PL,	PL,	PM,	PM,	PS,	ZE,	ZE,
//	PM,	PM,	PM,	PS,	ZE,	NS,	NM,
//	PM,	PS,	PS,	ZE,	NS,	NM,	NM,
//	PS,	PS,	ZE,	NS,	NS,	NM,	NM,
//	ZE,	ZE,	NS,	NM,	NM,	NM,	NL,
//	ZE,	NS,	NS,	NM,	NM,	NL,	NL
//};
// 
//static const _fuzzy_rules_t fuzzyRuleKi[7][7]={
//	NL,	NL,	NL,	NM,	NM,	ZE,	ZE,
//	NL,	NL,	NM,	NM,	NS,	ZE,	ZE,
//	NM,	NM,	NS,	NS,	ZE,	PS,	PS,
//	NM,	NS,	NS,	ZE,	PS,	PS,	PM,
//	NS,	NS,	ZE,	PS,	PS,	PM,	PM,
//	ZE,	ZE,	PS,	PM,	PM,	PL,	PL,
//	ZE,	ZE,	PS,	PM,	PL,	PL,	PL
//};
// 
//static const _fuzzy_rules_t fuzzyRuleKd[7][7]={
//	PS,	PS,	ZE,	ZE,	ZE,	PL,	PL,
//	NS,	NS,	NS,	NS,	ZE,	NS,	PM,
//	NL,	NL,	NM,	NS,	ZE,	PS,	PM,
//	NL,	NM,	NM,	NS,	ZE,	PS,	PM,
//	NL,	NM,	NS,	NS,	ZE,	PS,	PS,
//	NM,	NS,	NS,	NS,	ZE,	PS,	PS,
//	PS,	ZE,	ZE,	ZE,	ZE,	PL,	PL
//};